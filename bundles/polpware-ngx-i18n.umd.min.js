!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("@angular/core"),require("@polpware/fe-dependencies"),require("@polpware/fe-utilities"),require("@polpware/fe-data"),require("rxjs"),require("@angular/common")):"function"==typeof define&&define.amd?define("@polpware/ngx-i18n",["exports","@angular/core","@polpware/fe-dependencies","@polpware/fe-utilities","@polpware/fe-data","rxjs","@angular/common"],n):n(((e=e||self).polpware=e.polpware||{},e.polpware["ngx-i18n"]={}),e.ng.core,e.feDependencies,e.feUtilities,e.feData,e.rxjs,e.ng.common)}(this,(function(e,n,t,r,i,o,a){"use strict";var s=t.underscore;var u=function(){function e(e){var n=new i.SlidingExpirationCache(180,300,e);this._resourceLoader=new i.ResourceLoader(n)}return Object.defineProperty(e.prototype,"resourceLoader",{get:function(){return this._resourceLoader},enumerable:!0,configurable:!0}),e.prototype.loadPromise=function(e,n){var t=this._resourceLoader;return t.getPromise("lang.options",(function(e){return e})).then((function(e){return i.loadJsonUriP(e)})).then((function(n){return t=n,r=e||"en-us",(i=s.find(t,(function(e){return e.code.substring(0,2)===r.substring(0,2)})))&&(r=i.code),r;var t,r,i})).then((function(e){if(e===n)throw new Error("Loading the current language: "+e);return e})).then((function(n){return e=n,t.getPromise("lang.urlTmpl",(function(e){return e}))})).then((function(n){return r.replace(n,{code:e})})).then((function(e){return i.loadJsonUriP(e)})).then((function(e){return i.I18n.add(e.code,e.items),i.I18n.recycleOthers(e.code),e}))},e.prototype.loadOptionPromise=function(){return this._resourceLoader.getPromise("lang.options",(function(e){return e})).then((function(e){return i.loadJsonUriP(e)}))},e.ɵfac=function(t){return new(t||e)(n.ɵɵinject(n.NgZone))},e.ɵprov=n.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}(),l=function(){function e(){this._dict={},this.onTranslationChange=new n.EventEmitter,this.onLangChange=new n.EventEmitter,this.onDefaultLangChange=new n.EventEmitter,this.defaultLang="",this.currentLang="",this.langs=[]}return e.prototype.getParsedResult=function(e,n,t){return n},e.prototype.get=function(e,n){var t=[];t=(t="string"==typeof e?e.split("."):e).filter((function(e){return e}));for(var r=this._dict,i=0;i<t.length;i++){var a=t[i];if(!r[a]){r=void 0;break}r=r[a]}var s=void 0!==r?r:e;return o.of(s)},e.prototype.loadResources=function(e){Object.assign(this._dict,e)},e}();function c(e,n){if(e===n)return!0;if(null===e||null===n)return!1;if(e!=e&&n!=n)return!0;var t,r,i,o=typeof e;if(o==typeof n&&"object"==o){if(!Array.isArray(e)){if(Array.isArray(n))return!1;for(r in i=Object.create(null),e){if(!c(e[r],n[r]))return!1;i[r]=!0}for(r in n)if(!(r in i)&&void 0!==n[r])return!1;return!0}if(!Array.isArray(n))return!1;if((t=e.length)==n.length){for(r=0;r<t;r++)if(!c(e[r],n[r]))return!1;return!0}}return!1}function f(e){return null!=e}var h=function(){function e(e,n){this.translate=e,this._ref=n,this.value="",this.lastKey=null,this.lastParams=[]}return e.prototype.updateValue=function(e,n,t){var r=this,i=function(n){r.value=void 0!==n?n:e,r.lastKey=e,r._ref.markForCheck()};if(t){var a=this.translate.getParsedResult(t,e,n);o.isObservable(a.subscribe)?a.subscribe(i):i(a)}this.translate.get(e,n).subscribe(i)},e.prototype.transform=function(e){for(var n=this,t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!e||!e.length)return e;if(c(e,this.lastKey)&&c(t,this.lastParams))return this.value;var i=void 0;if(f(t[0])&&t.length)if("string"==typeof t[0]&&t[0].length){var o=t[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{i=JSON.parse(o)}catch(e){throw new SyntaxError("Wrong parameter in TranslatePipe. Expected a valid Object, received: "+t[0])}}else"object"!=typeof t[0]||Array.isArray(t[0])||(i=t[0]);return this.lastKey=e,this.lastParams=t,this.updateValue(e,i),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe((function(t){n.lastKey&&t.lang===n.translate.currentLang&&(n.lastKey=null,n.updateValue(e,i,t.translations))}))),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe((function(t){n.lastKey&&(n.lastKey=null,n.updateValue(e,i,t.translations))}))),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe((function(){n.lastKey&&(n.lastKey=null,n.updateValue(e,i))}))),this.value},e.prototype._dispose=function(){void 0!==this.onTranslationChange&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),void 0!==this.onLangChange&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),void 0!==this.onDefaultLangChange&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)},e.prototype.ngOnDestroy=function(){this._dispose()},e.ɵfac=function(t){return new(t||e)(n.ɵɵdirectiveInject(l),n.ɵɵinjectPipeChangeDetectorRef())},e.ɵpipe=n.ɵɵdefinePipe({name:"hyperTrans",type:e,pure:!1}),e.ɵprov=n.ɵɵdefineInjectable({token:e,factory:e.ɵfac}),e}(),p=function(){function e(){}return e.ɵmod=n.ɵɵdefineNgModule({type:e}),e.ɵinj=n.ɵɵdefineInjector({factory:function(n){return new(n||e)},imports:[[a.CommonModule]]}),e}();("undefined"==typeof ngJitMode||ngJitMode)&&n.ɵɵsetNgModuleScope(p,{declarations:[h],imports:[a.CommonModule],exports:[h]}),e.HyperTranslatePipe=h,e.NgxI18nModule=p,e.NgxTranslatorImplService=l,e.ResourceLoaderService=u,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=polpware-ngx-i18n.umd.min.js.map